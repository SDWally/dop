# 协程

- 一种不使用线程或进程的情况下，提供并发执行的技术

## 基于 yield 表达式

- 向函数发送值时，函数将执行
- 协程一般会不断地执行下去，除非被显示关闭或自己退出
- r.close() 关闭协程
- 协程关闭后，继续send，则会引发  StopIteration 异常（生成器会引发 GeneratorExit 异常）
- r.throw(RuntimeError, "some msg") 可在协程内部引发异常
- 协程可以选择捕获异常并以正确方式处理他们
- throw方法作为异步信号并不安全，不要使用单独的执行线程处理
- send方法的返回值，来源于下一个yield表达式，而不是接收send值的表达式

- 协程，编写数据流处理，程序（a处理完给b，b处理完给c，但是a(b(c()))） 不是c(b(a())).整个执行由 a驱动
- 一个集中式的任务管理器或事件循环

## 协程，微线程

- 微线程（基于任务调度器，生成器或协程，来实现协作式用户空间多线程）
- 处理1000个客户连接的网络服务器，使用异步IO或轮询，而不是创建1000个线程

### 处理逻辑

- yield语句，挂起函数的执行
- next或send 恢复
- 这样可以使用一个调度器，循环在一组生成器函数之间，协作多个任务
- 恢复任务并持续运行，直到抵达下一个yield为止，任务挂起
- 如果返回值是另一个协程，表示任务需要临时将控制权转移到该协程
- 

## 优势

- select 的性能随着它必须监视的连接数增加而递减
- 



 